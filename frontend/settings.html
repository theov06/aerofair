<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Configure AirLabs API for live Canadian flight data">
    <title>Settings - SkyVibe</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="logo/background_removed_logo.png" type="image/png">
</head>
<body>
    <nav class="navbar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: sticky; top: 0; z-index: 100;">
        <div class="logo">
            <img src="logo/background_removed_logo.png" alt="SkyVibe Logo" style="height: 50px; margin-right: 10px;">
            <span class="logo-text">SkyVibe</span>
        </div>
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>
        <div class="nav-links" id="navLinks">
            <a href="index.html">Flights</a>
            <a href="explore.html">Explore</a>
            <a href="deals.html">Deals</a>
            <a href="my-trips.html">My Trips</a>
            <a href="aerofair.html">AeroFair AI</a>
            <a href="settings.html" style="opacity: 1; text-decoration: underline;">Settings</a>
        </div>
    </nav>

    <section style="padding: 80px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);">
        <div class="container">
            <h1 style="color: white; font-size: 48px; text-align: center; margin-bottom: 20px;">‚öôÔ∏è Settings</h1>
            <p style="color: rgba(255,255,255,0.9); text-align: center; font-size: 18px;">
                Configure your SkyVibe experience
            </p>
        </div>
    </section>

    <section style="padding: 80px 20px; background: white;">
        <div class="container">
            <div style="max-width: 800px; margin: 0 auto;">
                
                <!-- API Configuration -->
                <div style="background: white; border-radius: 20px; padding: 40px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <h2 style="margin-bottom: 20px;">üîå AirLabs API Configuration</h2>
                    <p style="color: #666; margin-bottom: 30px;">
                        Connect to AirLabs API to get live Canadian flight data. Without an API key, the app will use sample data.
                    </p>

                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="font-size: 18px; margin-bottom: 15px;">How to get your API key:</h3>
                        <ol style="color: #666; line-height: 2; padding-left: 20px;">
                            <li>Visit <a href="https://airlabs.co" target="_blank" style="color: #667eea;">airlabs.co</a></li>
                            <li>Sign up for a free account</li>
                            <li>Get your API key from the dashboard</li>
                            <li>Paste it below and save</li>
                        </ol>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">API Key</label>
                        <input 
                            type="text" 
                            id="apiKeyInput" 
                            placeholder="Enter your AirLabs API key"
                            style="width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; font-family: 'Courier New', monospace;"
                        >
                    </div>

                    <div id="apiStatus" style="margin-bottom: 20px; padding: 15px; border-radius: 10px; display: none;"></div>

                    <div style="display: flex; gap: 15px;">
                        <button onclick="saveAPIKey()" style="flex: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 16px;">
                            Save API Key
                        </button>
                        <button onclick="testAPIKey()" style="flex: 1; background: white; color: #667eea; border: 2px solid #667eea; padding: 15px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 16px;">
                            Test Connection
                        </button>
                        <button onclick="clearAPIKey()" style="background: #dc3545; color: white; border: none; padding: 15px 25px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 16px;">
                            Clear
                        </button>
                    </div>
                </div>

                <!-- API Info -->
                <div style="background: #f8f9fa; border-radius: 20px; padding: 40px;">
                    <h2 style="margin-bottom: 20px;">üìä API Features</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div>
                            <div style="font-size: 32px; margin-bottom: 10px;">‚úàÔ∏è</div>
                            <h3 style="font-size: 18px; margin-bottom: 10px;">Live Flights</h3>
                            <p style="color: #666; font-size: 14px;">Real-time flight tracking</p>
                        </div>
                        <div>
                            <div style="font-size: 32px; margin-bottom: 10px;">üìÖ</div>
                            <h3 style="font-size: 18px; margin-bottom: 10px;">Schedules</h3>
                            <p style="color: #666; font-size: 14px;">Future flight schedules</p>
                        </div>
                        <div>
                            <div style="font-size: 32px; margin-bottom: 10px;">üõ´</div>
                            <h3 style="font-size: 18px; margin-bottom: 10px;">Airlines</h3>
                            <p style="color: #666; font-size: 14px;">All Canadian carriers</p>
                        </div>
                        <div>
                            <div style="font-size: 32px; margin-bottom: 10px;">üó∫Ô∏è</div>
                            <h3 style="font-size: 18px; margin-bottom: 10px;">Routes</h3>
                            <p style="color: #666; font-size: 14px;">Domestic connections</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 SkyVibe. Canadian domestic flight booking.</p>
        </div>
    </footer>

    <script src="api-config.js"></script>
    <script>
        // Load saved API key on page load
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('airlabs_api_key');
            if (savedKey) {
                document.getElementById('apiKeyInput').value = savedKey;
                showStatus('API key loaded from storage', 'success');
            }
        });

        function saveAPIKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            if (!apiKey) {
                showStatus('Please enter an API key', 'error');
                return;
            }

            localStorage.setItem('airlabs_api_key', apiKey);
            showStatus('API key saved successfully! Refresh the page to use live data.', 'success');
        }

        async function testAPIKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            if (!apiKey) {
                showStatus('Please enter an API key first', 'error');
                return;
            }

            showStatus('Testing connection...', 'info');

            try {
                // Test API call
                const response = await fetch(`https://airlabs.co/api/v9/flights?airline_iata=AC&api_key=${apiKey}`);
                const data = await response.json();

                if (data.response && data.response.length > 0) {
                    showStatus(`‚úì Connection successful! Found ${data.response.length} Air Canada flights.`, 'success');
                } else if (data.error) {
                    showStatus(`‚úó API Error: ${data.error.message || 'Invalid API key'}`, 'error');
                } else {
                    showStatus('‚úì Connection successful but no flights found at this moment.', 'success');
                }
            } catch (error) {
                showStatus(`‚úó Connection failed: ${error.message}`, 'error');
            }
        }

        function clearAPIKey() {
            if (confirm('Are you sure you want to clear the API key?')) {
                localStorage.removeItem('airlabs_api_key');
                document.getElementById('apiKeyInput').value = '';
                showStatus('API key cleared. App will use sample data.', 'info');
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('apiStatus');
            statusDiv.style.display = 'block';
            
            const colors = {
                success: { bg: '#d4edda', text: '#155724' },
                error: { bg: '#f8d7da', text: '#721c24' },
                info: { bg: '#d1ecf1', text: '#0c5460' }
            };

            const color = colors[type] || colors.info;
            statusDiv.style.background = color.bg;
            statusDiv.style.color = color.text;
            statusDiv.textContent = message;
        }

        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }
    </script>
</body>
</html>
